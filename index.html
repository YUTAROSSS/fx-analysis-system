<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>画像設定更新</title>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body>
    <h1>画像設定を更新します</h1>
    <button onclick="updateImages()" style="padding: 20px; font-size: 18px; background: blue; color: white;">クリックして更新</button>
    <div id="result" style="margin-top: 20px; font-size: 16px;"></div>

    <script>
        const supabase = window.supabase.createClient(
            'https://jfrwyunauatsybdljlah.supabase.co',
            'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Impmcnd5dW5hdWF0c3liZGxqbGFoIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTM1MTMxODksImV4cCI6MjA2OTA4OTE4OX0.cyhPTiN4WAQ2p86JBZObjSljt2i1K_bK-cGGo3soxAo'
        );

        async function updateImages() {
            const resultDiv = document.getElementById('result');
            resultDiv.innerHTML = '更新中...';

            try {
                // 現在のメインデータを取得
                const { data: currentData } = await supabase
                    .from('fx_analysis_data')
                    .select('*')
                    .eq('id', 'main')
                    .single();

                // 画像の設定を追加
                const imageSettings = {
                    "USDJPY": {
                        "scenario1": ["https://jfrwyunauatsybdljlah.supabase.co/storage/v1/object/public/fx-images/USDJPY.jpeg"],
                        "scenario2": ["https://jfrwyunauatsybdljlah.supabase.co/storage/v1/object/public/fx-images/USDJPY2.jpeg"],
                        "scenario3": ["https://jfrwyunauatsybdljlah.supabase.co/storage/v1/object/public/fx-images/USDJPY3.jpeg"]
                    },
                    "EURUSD": {
                        "scenario1": ["https://jfrwyunauatsybdljlah.supabase.co/storage/v1/object/public/fx-images/EURUSD.jpeg"],
                        "scenario2": ["https://jfrwyunauatsybdljlah.supabase.co/storage/v1/object/public/fx-images/EURUSD2.jpeg"]
                    },
                    "GBPUSD": {
                        "scenario1": ["https://jfrwyunauatsybdljlah.supabase.co/storage/v1/object/public/fx-images/GBPUSD.jpeg"],
                        "scenario2": ["https://jfrwyunauatsybdljlah.supabase.co/storage/v1/object/public/fx-images/GBPUSD2.jpeg"],
                        "scenario3": ["https://jfrwyunauatsybdljlah.supabase.co/storage/v1/object/public/fx-images/GBPUSD3.jpeg"],
                        "scenario4": ["https://jfrwyunauatsybdljlah.supabase.co/storage/v1/object/public/fx-images/GBPUSD4.jpeg"]
                    },
                    "AUDUSD": {
                        "scenario1": ["https://jfrwyunauatsybdljlah.supabase.co/storage/v1/object/public/fx-images/AUDUSD.jpeg"],
                        "scenario2": ["https://jfrwyunauatsybdljlah.supabase.co/storage/v1/object/public/fx-images/AUDUSD2.jpeg"]
                    },
                    "SILVER": {
                        "scenario1": ["https://jfrwyunauatsybdljlah.supabase.co/storage/v1/object/public/fx-images/SILVER.jpeg"],
                        "scenario2": ["https://jfrwyunauatsybdljlah.supabase.co/storage/v1/object/public/fx-images/SILVER2.jpeg"]
                    },
                    "GOLD": {
                        "scenario1": ["https://jfrwyunauatsybdljlah.supabase.co/storage/v1/object/public/fx-images/GOLD.png"]
                    }
                };

                // 既存のデータに画像設定を追加
                const updatedData = {
                    ...currentData.data,
                    images: imageSettings
                };

                // データベースを更新
                const { error } = await supabase
                    .from('fx_analysis_data')
                    .update({
                        data: updatedData,
                        updated_at: new Date().toISOString()
                    })
                    .eq('id', 'main');

                if (error) {
                    resultDiv.innerHTML = `エラー: ${error.message}`;
                } else {
                    resultDiv.innerHTML = '✅ 成功！画像設定が完了しました。';
                }

            } catch (err) {
                resultDiv.innerHTML = `エラー: ${err.message}`;
            }
        }
    </script>
</body>
</html>
